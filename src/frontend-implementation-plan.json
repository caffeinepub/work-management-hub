{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add pending users approval feature to InternalDashboard",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Add state management for pending users and loading state to InternalDashboard.tsx",
      "acceptanceCriteria": [
        "pendingUsers state is initialized as empty array",
        "isLoadingPending state is initialized as false"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Add state declarations for pendingUsers (array) and isLoadingPending (boolean) at the top of the component, initialized to empty array and false respectively"
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Implement fetchPendingUsers function with loading state management and error handling",
      "acceptanceCriteria": [
        "Function checks for backendActor availability before executing",
        "Sets isLoadingPending to true before API call",
        "Calls backendActor.getPendingRequests() and stores result in pendingUsers state",
        "Handles errors with console.error logging",
        "Sets isLoadingPending to false in finally block"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Add fetchPendingUsers async function that guards against missing backendActor, sets loading state, calls backendActor.getPendingRequests(), updates pendingUsers state, and handles errors with console.error in try-catch-finally block"
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Add useEffect hook to fetch pending users for admin and superadmin roles",
      "acceptanceCriteria": [
        "useEffect triggers when currentUser or backendActor changes",
        "fetchPendingUsers is called only when currentUser role is 'superadmin' or 'admin'",
        "No fetch occurs for other user roles"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Add useEffect hook with dependencies [currentUser, backendActor] that conditionally calls fetchPendingUsers only when currentUser role is 'superadmin' or 'admin'"
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Implement handleApprove function to approve users and refresh the list",
      "acceptanceCriteria": [
        "Function accepts principalId parameter",
        "Calls backendActor.approveUser with principalId",
        "Calls fetchPendingUsers after successful approval to refresh list",
        "Handles errors with console.error logging"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Add handleApprove async function that accepts principalId parameter, calls backendActor.approveUser(principalId), refreshes the list via fetchPendingUsers(), and handles errors with console.error"
        }
      ]
    },
    {
      "id": "REQ-5",
      "summary": "Implement handleReject function with confirmation dialog to reject users and refresh the list",
      "acceptanceCriteria": [
        "Function accepts principalId parameter",
        "Shows confirmation dialog with text 'Yakin ingin menolak dan menghapus user ini?'",
        "Only proceeds with rejection if user confirms",
        "Calls backendActor.rejectUser with principalId after confirmation",
        "Calls fetchPendingUsers after successful rejection to refresh list",
        "Handles errors with console.error logging"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Add handleReject async function that accepts principalId parameter, shows window.confirm dialog with Indonesian confirmation text, calls backendActor.rejectUser(principalId) only on confirmation, refreshes the list via fetchPendingUsers(), and handles errors with console.error"
        }
      ]
    },
    {
      "id": "REQ-6",
      "summary": "Replace Admin Panel card placeholder with pending users table showing name, role, and action buttons",
      "acceptanceCriteria": [
        "Admin Panel card content is replaced with pending users display",
        "Table or list maps through pendingUsers array",
        "Each row displays user name and requested role",
        "Each row has Approve button styled in green/primary color",
        "Each row has Reject button styled in red/destructive color",
        "Approve button calls handleApprove with user principalId",
        "Reject button calls handleReject with user principalId"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Replace the Admin Panel Card placeholder content with a table or list structure that maps through pendingUsers array, displaying each user's name and requested role, with Approve button (variant='default' or green styling) calling handleApprove(user.principalId) and Reject button (variant='destructive' or red styling) calling handleReject(user.principalId). Use existing shadcn/ui Table and Button components."
        }
      ]
    },
    {
      "id": "REQ-7",
      "summary": "Display empty state message when no pending users exist",
      "acceptanceCriteria": [
        "Empty state message is shown when pendingUsers.length equals 0",
        "Message text is exactly 'Tidak ada permintaan pendaftaran baru'",
        "Message is displayed in the Admin Panel card area"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/InternalDashboard.tsx",
          "operation": "modify",
          "description": "Add conditional rendering in the Admin Panel Card that displays the text 'Tidak ada permintaan pendaftaran baru' when pendingUsers.length === 0, styled appropriately as an empty state message"
        }
      ]
    }
  ]
}